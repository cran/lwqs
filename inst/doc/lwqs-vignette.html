<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Paul Curtin, Stefano Renzetti, Chris Gennings" />

<meta name="date" content="2021-03-03" />

<title>Introduction to Lagged Weighted Quantile Sum Regression</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      a.sourceLine { display: inline-block; line-height: 1.25; }
  a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
  a.sourceLine:empty { height: 1.2em; }
  .sourceCode { overflow: visible; }
  code.sourceCode { white-space: pre; position: relative; }
  div.sourceCode { margin: 1em 0; }
  pre.sourceCode { margin: 0; }
  @media screen {
  div.sourceCode { overflow: auto; }
  }
  @media print {
  code.sourceCode { white-space: pre-wrap; }
  a.sourceLine { text-indent: -1em; padding-left: 1em; }
  }
  pre.numberSource a.sourceLine
    { position: relative; left: -4em; }
  pre.numberSource a.sourceLine::before
    { content: attr(title);
      position: relative; left: -1em; text-align: right; vertical-align: baseline;
      border: none; pointer-events: all; display: inline-block;
      -webkit-touch-callout: none; -webkit-user-select: none;
      -khtml-user-select: none; -moz-user-select: none;
      -ms-user-select: none; user-select: none;
      padding: 0 4px; width: 4em;
      color: #aaaaaa;
    }
  pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
  div.sourceCode
    {  }
  @media screen {
  a.sourceLine::before { text-decoration: underline; }
  }
  code span.al { color: #ff0000; font-weight: bold; } /* Alert */
  code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
  code span.at { color: #7d9029; } /* Attribute */
  code span.bn { color: #40a070; } /* BaseN */
  code span.bu { } /* BuiltIn */
  code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
  code span.ch { color: #4070a0; } /* Char */
  code span.cn { color: #880000; } /* Constant */
  code span.co { color: #60a0b0; font-style: italic; } /* Comment */
  code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
  code span.do { color: #ba2121; font-style: italic; } /* Documentation */
  code span.dt { color: #902000; } /* DataType */
  code span.dv { color: #40a070; } /* DecVal */
  code span.er { color: #ff0000; font-weight: bold; } /* Error */
  code span.ex { } /* Extension */
  code span.fl { color: #40a070; } /* Float */
  code span.fu { color: #06287e; } /* Function */
  code span.im { } /* Import */
  code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  code span.kw { color: #007020; font-weight: bold; } /* Keyword */
  code span.op { color: #666666; } /* Operator */
  code span.ot { color: #007020; } /* Other */
  code span.pp { color: #bc7a00; } /* Preprocessor */
  code span.sc { color: #4070a0; } /* SpecialChar */
  code span.ss { color: #bb6688; } /* SpecialString */
  code span.st { color: #4070a0; } /* String */
  code span.va { color: #19177c; } /* Variable */
  code span.vs { color: #4070a0; } /* VerbatimString */
  code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to Lagged Weighted Quantile Sum Regression</h1>
<h4 class="author">Paul Curtin, Stefano Renzetti, Chris Gennings</h4>
<h4 class="date">2021-03-03</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(lwqs)</a></code></pre></div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The lWQS package provides a convenient wrapper based on the gWQS and gamm4 packages to implement lagged weighted quantile sum (lWQS) regression<sup>1</sup>. This provides an approach for the estimation of time-varying mixture effects, particularly in contexts of environmental medicine and public health. The general premise of the procedure is to integrate the generalized weighted quantile sum regression (WQS) algorithm<sup>2</sup> in a longitudinal context with repeated measures. To achieve this, WQS is applied to estimate mixture effects at specific time points; the mixture indices derived from WQS are then used to construct a longitudinal model, consistent with the reverse distributed lag approach outlined by Chen et al<sup>3</sup>. The package is currently in development and users should expect syntax and functionality to evolve over time.</p>
</div>
<div id="general-usage-requirements-and-data-structures" class="section level2">
<h2>General Usage, Requirements, and Data Structures</h2>
<p>Lagged weighted quantile sum regression is used to link fixed outcome data to the mixed effects of multiple time-varying predictors. Repeated measures should be organized in “long” format, with each row representing a successive observation per subject. For purposes of estimating confidence intervals the package assumes a z-scored outcome distribution.</p>
<p>The package includes a simulated data set (lwqs_data) that illustrates the intended data structure for use of this package. Data can be attached and viewed as in the below:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">library</span>(lwqs)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">data</span>(lwqs_data)</a></code></pre></div>
<p>The simulated data are structured as in below snippet (use head(lwqs_data) to reconstruct) from the lwqs_data. Note that each simulated person - identified by the “ID” variable - has a single fixed outcome, identified as “outcome”. The outcome variable was simulated from a standardized (z-score) Gaussian distribution. A simulated binary covariate, “sex”, was also generated from a binomial distribution. As well, each individual has 5 simulated predictor variables (pred1-pred5) which are measured at 30 distinct time points (“time”). In an environmental epidemiological study design, this might correspond to 5 measurements of exposure collected at each month post birth for a total of 30 months; and, our goal is to identify the developmental window at which the mixture of exposures relates to our health outcome, while adjusting for a covariate (s) such as sex.</p>
<p>Note the provided data are “balanced” in the sense that all participants are sampled at every sampling interval. In practice, with data providing incomplete or unbalanced coverage, it may be necessary to prune, aggregate, or otherwise manipulate data to ensure reliable estimates. If only a handful of subjects were observed at a given sampling interval, for example, it will be difficult to generate reliable estimates; or, if a given sampling interval only includes 1 level of some key covariate (e.g., only females are sampled at time point 3 in a model with sex as a covariate) this may compromise model convergence and/or effect estimation.</p>
<pre><code>#&gt;    ID sex time        out      pred1      pred2      pred3      pred4      pred5
#&gt; 1   1   1    1 -0.8322414 -0.2062299 1.30295010 -1.3870911  0.1607504 -0.1757468
#&gt; 12  1   1    2 -0.8322414 -0.0941091 0.42957397 -0.4552804  0.3642088 -1.1884153
#&gt; 23  1   1    3 -0.8322414  2.9357351 0.01995526  0.7725593  0.8464955 -1.4320769
#&gt; 25  1   1    4 -0.8322414 -1.3437874 0.86728598  0.7679771  0.1602173 -0.7590517
#&gt; 26  1   1    5 -0.8322414  0.7142656 0.30884399  0.7302721  0.1933808  0.3498828
#&gt; 27  1   1    6 -0.8322414  0.6871639 1.26009045  0.9717983 -0.0763416  0.6857857</code></pre>
</div>
<div id="simulation-parameters" class="section level2">
<h2>Simulation Parameters</h2>
<p>Simulated data were generated with autoregressive models to approximate expected patterns of within-subject correlation. As well, each predictor was simulated with a time-varying association with the health oucome.</p>
<p>Predictors 1 and 2 have no association with the outcome at time points 1-10 and 21-30; but, at time points 11-20 have either a strong positive association with the outcome (predictor 1) or a weak positive association with the outcome (predictor 2).</p>
<p>Likewise, predictors 3 and 4 have no association with the outcome in months following time point 10, but from time 1-10 have either a weak (predictor 3) or strong (predictor 4) negative association with the outcome.</p>
<p>Predictor 5, unlike the others, has no association with the outcome at all.</p>
<p>The below plot illustrates these parameters. On the y-axis the simulated associations between each predictor and the outcome are shown, plotted against the change in these parameters over time (x-axis). Beta 1, beta 2, etc, refer to the effects associated with predictor 1, predictor 2, etc.</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="application-of-lwqs" class="section level2">
<h2>Application of lWQS</h2>
<p>With respect to the effects summarized above, the lwqs algorithm should identify a negative mixture, comprised of predictor 3 (weak effect) and predictor 4 (strong effect) from times 1-10; and, likewise, a positive mixture, comprised of predictor 1 (strong) and predictor 2 (weak) from time points 11-20. There should be no significant mixture effects from times 21-30.</p>
<p>To dissect the counteracting effects of mixtures acting in opposing directions, the lWQS algorithm leverages the usage of constraints implemented in the weighted quantile regression procedure (see gWQS package for details). In practice this means the algorithm is run twice in succession; first, examining mixture effects that may relate positively to the outcome of interest, and then again to examine negative associations.</p>
<p><strong>Note that lwqs is generally a computationally-intensive procedure involving multiple ensemble steps. For example, the estimation of a model across 30 time points, with 50 bootstraps at each time point, will involve more than 1500 discrete models. Patience is a virtue in this pursuit.</strong></p>
<div id="identifying-mixture-effects-positively-associated-with-outcomes" class="section level3">
<h3>Identifying mixture effects positively associated with outcomes</h3>
<p>The below code is used to implement the lWQS algorithm.</p>
<p>First, it is neccesary to identify the time-varying predictors that will comprise the mixture. In our simulation data, these are pred1-pred5, which correspond to columns 5-9 of lwqs_data. In the below code we save these to an index called “mixvars”</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">mixvars=<span class="kw">names</span>(lwqs_data)[<span class="dv">5</span><span class="op">:</span><span class="dv">9</span>]</a></code></pre></div>
<p>Next, we specify the call to the lwqs algorithm. Each parameter will be explained as follows, but in general this involves specifying the identity of a few key variables (ID, time, and outcome variable names), and specifying the desired parameters for the mixture (wqs_parms). Each parameter is identified in the accompanying comments. For now we will ignore covariates. Parameters specific to the longitudinal component of the model (rDLM_parms) are automatically passed to gamm4. For users that may wish to modify these parameters for covariate adjustment, model selection, etc, we recommend the use of the extract_function() procedure explained subsequently.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">posmod=<span class="kw">lwqs</span>(<span class="dt">data=</span>lwqs_data,                       <span class="co">#specifies the dataframe containing study data</span></a>
<a class="sourceLine" id="cb5-2" title="2">            <span class="dt">timevar=</span><span class="st">&quot;time&quot;</span>,                       <span class="co">#specifies the variable that denotes temporal intervals</span></a>
<a class="sourceLine" id="cb5-3" title="3">            <span class="dt">wqs_parms=</span><span class="kw">list</span>(<span class="dt">formula=</span>out <span class="op">~</span><span class="st"> </span>wqs,     <span class="co">#formula for the WQS component of the model, applied at each timepoint</span></a>
<a class="sourceLine" id="cb5-4" title="4">                           <span class="dt">data =</span> lwqs_data,      <span class="co">#data frame, as above, for reference by the gWQS algorithm     </span></a>
<a class="sourceLine" id="cb5-5" title="5">                           <span class="dt">mix_name=</span>mixvars,      <span class="co">#mixture variables, identified previously</span></a>
<a class="sourceLine" id="cb5-6" title="6">                           <span class="dt">b1_constr =</span> T,         <span class="co">#specificies use of a directionality constraint</span></a>
<a class="sourceLine" id="cb5-7" title="7">                           <span class="dt">b1_pos=</span>T,              <span class="co">#specifies directionality of constraint, in this case positive</span></a>
<a class="sourceLine" id="cb5-8" title="8">                           <span class="dt">b =</span> <span class="dv">5</span>,                 <span class="co">#specifies number of bootstraps used at each temporal interval</span></a>
<a class="sourceLine" id="cb5-9" title="9">                           <span class="dt">q =</span> <span class="dv">5</span>,                 <span class="co">#specifies quantiling, in this case to quintiles. </span></a>
<a class="sourceLine" id="cb5-10" title="10">                           <span class="dt">validation =</span> <span class="dv">0</span>,        <span class="co">#specifies that no validation split is done on the data</span></a>
<a class="sourceLine" id="cb5-11" title="11">                           <span class="dt">family =</span> <span class="st">&quot;gaussian&quot;</span>,   <span class="co">#indicates identity link appropriate for gaussian outcomes</span></a>
<a class="sourceLine" id="cb5-12" title="12">                           <span class="dt">seed =</span> <span class="dv">1</span>),           <span class="co">#specifies seed for reproducibility</span></a>
<a class="sourceLine" id="cb5-13" title="13">            <span class="dt">outcome=</span><span class="st">&quot;out&quot;</span>,                        <span class="co">#specifies outcome variable</span></a>
<a class="sourceLine" id="cb5-14" title="14">            <span class="dt">ID=</span><span class="st">&quot;ID&quot;</span>)                              <span class="co">#specifies ID variable that identifies each subject</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<pre><code>#&gt; `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwAAAAGACAMAAAAtcPVNAAAA7VBMVEUAAAAAADoAAGYAOmYAOpAAZrYAsPYAv30SEhIzMzM6AAA6ADo6AGY6OmY6OpA6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOgBmOpBmZjpmZrZmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQOjqQOmaQkDqQtpCQ27aQ29uQ2/+jpQCrbk2rbm6rbo6rq6uryKur5P+2ZgC2Zma2/7a2//+4uLjIjk3I///bkDrb2//b/7bb///kq27k///na/Pr6+v4dm3/tmb/yI7/25D/29v/5Kv//7b//8j//9v//+T////a4Ft6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2dC3sbN3aGmdSWFHtbK3G8u+0qFyexd7ut6V2v1Ua22tikZFeWPP//55SYG27nAAcgMMBwzvckMkXiAJjR9xKXwWBWDYu1YK1KV4DFKikGgLVoMQCsRYsBYC1aDABr0WIAWItWHABfsfZW7F+sdL0nUuzpCVUkAOLHNjgsPGKakBL1igeAVvgc0yiJGIApQxiAOtIwAIVCGIA60jAAhUIYgDrSMACFQhiAOtIwAIVCGIA60jAAhUIYgDrSMACFQhiAOtIwAIVCGIA60jAAhUIYgDrSMACFQhiAOtJUCcDND2/bf29/On38fniTAWAAMqSpEYAPp9+0AHx++ax59+3wLgOwJACuhKYoq0IA3nz9j64FuP3l7dgYMACLAuCqV/6yKgRg7ALd/Pi+uf35ddMvx92y9tRcALhSlLusmgH48HgAQIhbgIW0AFe6spbVVA2AbAGEGIBlAKD43kXAEgDgMUDikDkAoJseJ2AJAHx++ZRngVKGzAYA/TcQgYMHQPzP1wHShswAgNbvW+N3iICDBgAUA7AUAPQ0CAEMAFEMgFT9AHRe39pvWgQwAEQxAFJzBsAkgAEgigGQqh6A3uhmGgZAiAFYLAANA9AwAAsAYPC5ncYmgAEgigGQYgCciRiAKUMYAEujy4E0FgEMAFEMgFTdAFz5ANAIYACIYgCk6gcAT2MSwAAQxQBIzR4AhQAGgCgGQKpqAK7cAJhNAANAFAMgNWsADAIYAKIYAKmaAVDtzQBAYgAWDoBOAANAFAMgVTEAFHMzAHMxWjWFHBYADQMwE6NVU8i8APDmQ+gmBdeHASgUwgBoogPgnCkKrw8DUCiEAVBFnOFRCGAAiGIApOoGgJIPAxAcxgBIzR8A54rRqPowAIVCGABV9GUO+D0DcfVhAAqFMACKAtb5MACBYgCkqgaAmg9233BkfRiAQiEMgFTQWn8GIEwMgFQ8AHmfW9ACEJQ6SzUYgClD5gVA/haAnk/XXnALQBQDIFUpAKH3+zIAIWIApBgAZyIGYMoQBmCQ5X8GABQDwAAoAQsEIMvIf1GqF4CwfBYKgPgxj2/aagqZTQsQlg8DECAGQKpKAOweEAkA52PkA+rDABQKYQB6AWZmACAxAAyAGkMggAGIimAALDEAScUATFXIDACAvOzPh0YAAxAVwQBYygxAeD4MAFkMgFSFAIBGJuTDAFDFAEgdGABeAhiAqAgGwFI2AGAbU/JJBMDREQNQJoQBaNDv8UkBODoaXjMAU4YwAA3qYioAPgIYgKgIBsBShQBsGQCaGACp2gDAvsWXBcDlanV2ee83bxQDwACoaQh9oFkAcH7vf5+c3T2/741iAA4NANTCtHxSAHBUHIBPT852/zXXX/7qi2IAGAAtTSoAxl8YgClDGAC8D7NLs+7lyMffB5oDAM2l6AJ9evLIG8UALAaAtSY0n8MAoLle7eT3PwNwiACASdaW4HwOBACqGIBlAGDbHyQgCQBH5QG4e35GjGIADgsApAekWx5HYEu4GEwCQCYqNQgmRjEAhweA/bHtdoSALZpFQH0qAKChXANrxQAsBQArH4iAQwHg05NVK54GnSCkfgA6o9v52AQcCgB0MQAHBQDYgV87AVib+fgGAQxAVAQDYCkTAOZng8uBfCwCtlgmAfU5qgAA7gJNGFIRANCX99oBgEVAKgCaKlqAT79/4Y2qDoCLVrGlMAAwAGg+BgEjAA4C5gNAc+2fC6oLgAtFUaUwAKj/kXx0ArZYNgH1qQmAmXWBLnRVUy93SD0AAF/dir2RfDQCDgyA81m1ABeW6qiXL6RmANZ+AIA07j7QHADoB8FfzGkMYPv/4tUwGChZL29INQC4/Y/no6TCu1Lk+hzVAACg259OH79vX707PT395m3/di0AAPZvAVDHxCXqRQipHQB/PskB2JQGoF8LpIwBPr981rz7tn355pmSshIAQP9LAMgYLB4A/W17hgeWOVPk7AP5AdhsNtUBcPvL2+bmB/G9//lvr5WUdQAA+98EgMDAJABc1AmApwFw5mNeK9gLgI3Q+HsBAC5Xg+RN8Tc/vm9ufxbW3/WFTk/bRuArodKPmBN6FaLSld1VV//1YABYpwFgUxwAaDn0h8cDADffv1ZagRpaAOT7H2oBfO3A0lsA7U3oKi8mAACMAHd9ev8X7gLd/Y/5qWwBWo3jgAoAQP2PAoAjMAUA5vSs/y8sJyA+KPMPiQHwNQCefLrEY5poAPrv/+JjgPZ24Lu/AGOAVhUBgPvfAQBGQJUAyAkI8RfopyKa7ACAC91wpQSgKQ1Ac72699vuhzoL9LQ/9aIz9Pnv1UyDOvzvAgBBYAIALoIB0L985KukAMD+XwfkI5JrACAEOPMZ+v+lAeguhakbw3XNcPsVdHr69dgXKgyAy+EeAEACqgRA7352X0PJJyBax6pvtP4PyUEPMLMjSvj/SHun1IWwjw8ou6LMGQAIgSoBkBMQOxi+07580rYA6jvm9z8hHy0iqgVov//bHSFKtwB3z1f3226QT2UB8BjcB4BNQH4ALvZtAeSr7ACE5qPG4H0gPJ9NNQB8eiKWAX16UvlqUJ+/vQBYDFQJgGMCIhsAtv8DAcCbADQfxf/FAfhT9+9/VQ2A19wUAHQGqgRAn4DI0wIYX9h2B4iUj9kEhNWn938NANBVEAC/s4kAKBhkB+AiAgDHBERSAOSvkP+pAAxxwQAM/i8OQLs1dP33BBM8HQRAF7F/vdyKAgBRNgCsGVByPnsA0E2ARgHw8aF/3b5fM2sBSHYOB+Ai7y0EF/MBIC4fGYmOguF8NnsAkEbzAoBs53AAAhE4PABg/4cCgDYBDgAaBoAYEmLncACCCDgIANSva8T/xLL0JoBcn+EKMBWAjw//+mC1evRx9+NMdIEuv3jRKM+z6D4+ay9niW3+teRikh/o3TMAFzH3kAUdykXNAPQv4QEAMZ+tgk8wAI2yM7oXgAf3fmsuxZWqyy9/FWOA8/viP/3jL39tlzWLFGry9tl39u63IwCCj1Xdg+BQO4cDkOcuytkAEJuPCQD1aZPDHQDjkwH8AJwNPx6+EADsvuN/96vx8cMX/ydcLlKoydv7vOwV/7IFuG7bCZqKABBu54iIDIcyZF0dAIpXUf9TyxozyAuAmPgZfrT/XqqmlR9ft5s7aMn7G77MlT76Y1KpDJQAIMbOERHpD6VqAPqXqP+DAcAIAPIZbwHbA4Bzde3m8Em7pGFIMQIAL/ExxgCiI0RgoEYATnZKAACRAPqhjBlXDADuf3JZ4QBsEgBw/eV/K52a4ZN2b8NrowW4hrf7sQfBd8+rHAP43T9qPwBoBBwAANKpeAcoDID1mC8hn00CAIyn+qpe//jAAODuubjZxaLAbgEI+2JVBsCJrX0AIBFAPhSZbY0AdK8c/qeX5WkCYAC6l9EAiE0M29kd4+NdX/6L/3hypiVveze2ufWH5JHc35QAIMT9wQxYnaaEhzIDAFz+DyjLPQw281E3gSADkEHqLBDR/U0BACjut2GIBsBPAPVQlDwrA+AqFwBwH8jIx/R/eQDqvg7g9T9ORRQAXgYOA4D2hdP/IWU5mwA9nw3YAEQC0F73pW1qa2seV4I99rfsHEgAMm+U4FDU7OoCYHSpawRMyEdJQwdA3wVrXwD20mwBwB3+yolHAAAuAg4GAI//g8pyEWADMP7GAPhCcP877UxmIHwfCeKhaPnUB8DWsQaImo+aJggA+RsD4AlB/e+3M42B8NvoaYeiZ1IVAN1+KH7/h5XlIEDNx24AGABXSJj/DTtThgOEa8cxh2JkUS0A++Sjp4kGwEpU6JZI6mq4wgC4/WzYmUBA+D4SlEMxc6gJgM6h6jr+uHzMNCoBaD4brAfEAIAhgf4H7OxDgLZ6KPBQrPgKAfA3ABEArBuoCageAOX5AJVdB4D9jBsVtLOTgfCNVPyHYodnA0D3E6mCnT/TA4A3AQYAyie1AADdLYBpSgBC/Y/aGWeAvH6UfihAsBcA+wk9kDQANqqME+dS50+C/zMAAPi/EgDoKg6Ay6W4nbHhAH0BNfFQwNjkAGwsaSfOpawArJtQAOxEhQC4hO6ZATQhAKCLnSZ12PnkBGQg5A4C/6FgkR4AoEdUQXIBoDjLea67LjrF/8HjDWwQMKYx26qaALjsbpv0E1AQAP+FLbedIQbC95JDD8URSG0BPAIAUFkYT5wrD+n/ta+4SACsJmAOANCaYKHpADC9Sbiw67WzxUDgPWToobjD0g+CDStpCBAB8BYXA8C6wQGwBivzBCDiIQhxMh722Jk26PmQoDQGgqMpNfVFQX/hflljwCDYkEKAFwCa/7MDcJQbgLvnwtUff4ec1Mq7QOBVLc8XNPH7HBkP0GQeCiXG2wIo9zY55LwOIAlwneurAQBCccHXHBAClG6bFqv6nwDAlS1P5VoArtFvlcoHwdC6Bp/R6B2aPQgYDyUiRJ5CXaFjAFADAT4AhE0TLKmw05QD4NMf/l3cE/Dxn/8o9sZadd/mq3/641lz/sVfSS0AWVMBYLiZZtWgHn0sAuFbT1BagFQAbJxprrICgBCwHWunx6YE4Mm9367FfnC703j+qLm83/5zvaJ3gcgqAwDRqKHejGIgGIATwiCYMPryL4XoCfAA0Jp0cgDs63VpAThr7v78Qnj90+9f7BqEX3f/BY0ByCoIQAZvXrwKZyCCMjcAw8MZ9hoEt+oIcAOwzggAPBM6AqCnPQoEwCXh+ub8rAXgSbc1nLD9+XwB0I1GNWjUxlihBAQWInLWT3XGxXDAwghVcgRcCQBQRrEADC3AH1q/z70F0IxGtmfcznCBBIQVcjIpAB4C5AxQJgBAAraNvwe0LwBP7jfX937rvvYfiZeBY4DaLoRpRqO7M3prxBAGIkbahFkgymIIynJoFwHKJYASABhJ07YA/9bOAv2um/4Rm0TcPW9ngQ4GgBA7B8i6izhtIX2e/kHwcB3GeUGAdD+AE4DxElguACACJgEgYl8U6H4A/+WYSQDQjJatd6JHkBuBgEKGDKnXAXZfQK7vINoNMTgBV+tSACA9oFoAqO5+AM1o+canF9Bca6rLzRdK321SAOC7ZBqtAcgHAEDAltAAlF4LRNcUAGhGI/u/K4XsTtDNFATIAMi86F0g4Ek+WiDJlAgB6hqgvACIQuRE/RZslCoD4O75I9qClBoBMEqhGhR0s78ZoAKg5ENYDSoebLI6ay5dm/yFAGAToK2ByweA3QTMAoD2eWMUAiYAQDOa1/9QKUSLgm72EhC04q57TQCAIvJN8SAB62IAgNWpC4CqZoFUo7m86CiF5lHEzR4EaABoWRQBwLCcfhPMRAC0BIAAHDEAmDSjoUb0lUJyqWcfiYAQOI/hF99SiLPhOoBnKQT5XopuSYSqzv/BN2VEaCxIAABXZifhfzj+gG6JVHwaCQBiQyx0C2TjlmcfiZAQO3z8deoWAJh3NG6CydgCWH0gSg+odAvQD8JS3g+gm5UOgGY02IRorF4KwaiEfSQCQoxQ+cb0ABiu677/rSXKhHwi0ph9IHBIXh0AVNEAsOwaBwBoQEesUYrXqaR9JAJCtEDlHQIAl6vVmWsKtA8MA2DwXe//MgDAk7KHDYBtWTIAqtFA/7mCrVJ8XnW7GUbABwAQ4wfg/N7/PjnzzcIFbY0oAVjb/s8KgEHATACgfAMJEQCwPUEHQDNaqP+BUjxmJW6kEhACTlxRrgQbz/2EFLY3aE/AaP9CACBX5WoDgPQNJOQHADJFFADB/odLcbo1oj9DYcZ4syAAiv8nA0AjAG8AagKA9gcQMgCwLQn7gj5vJI2WCAC0Tn43K5aWVSH0mtxHDy6FEF9Avlm4wN2hWwL62R9zD4XJACA2AFkAEDfEiP1mkHVuiQAwPIkZjVRjy0tmNp74oMG5382aqSmbyWETR9SlEJ5ZuFgA3Ds2e/OJSCMJSAfA2pancjsAxDLR9nnZgPTrAJRvoLF6GgCqL1FrkACw3WRm48kgZHrW62bb2CeeEPTaQYFp0J3WPQBNGQC6cqcBAN0W5Vp06s/hJiDJdQCSf1rX+LPeuwEIuEAn60XSyYlkIOLaGWEMgLXTRmAwAJt143lqizefiDSjPbGbE1ID4NgWBb1ZIMk0KM0/rWu8Wdt+MnPx5RA+2RqzlZbrUzjW3wJ0Dyv39EAVAFzt/3ZIse7dB+yilhmAkQBsl4rkAODbooiFzqCSPCKJap9XfvvajjIz8VYu/HJb+P2NgM/dbFyQu0B3z6mzQM4+8FZ6pSPA9v8cAXDJsS0K3q+fHAC3gQG3GW/5Kxe0SE/Wi6oTj9BAEgDX6HSFEqgDACOgfEO2AAD+zw7AQICoALCFpzULmgAAeFuUtlcEK8kzwqjeeeWzMOA14y3CeQgCwNx8iKQo/9O6QP6rkAAANgP6B60BywGwcQCAZZR0WxSH/9PcE0w1ziu3iUGjGW8RKhcIgLkBKU2h7r/Iszku0CUGOsg9AFZW2QFoRgCgTZyTA4Bti9J9t3tmgSbrAqE2Bk1meJNSuVAA7Kdw0A4lyP0XpC7QeVAL0MrrfiHEgtMAgOGXAYB9doWYFADIyHbyyQCwH0QWcChkkcYAHx/QxwCDfPZHO+H5AWgkAFb59hCgKADTjQE6mVnaqdtvVd1opEOKACB4H4lsAOx0HrEWyHa/ngaeiJ8EAHQIbvu/grVA5se3P50+fm+8apIAoJkZTG0DQDukKAD23EmFIj8A/SOSkq4FanUFX4qaDgCIgPoAsPX55bPm3bf6K6EUAPjUdasnAyDgMIIPpRPlSjDtKnw4APBihCkAUC7DGR9VBkD79d+ug1MWw93+8ra5+eGt9mqsXl4ATmwAiIcUDUDIsWTsAjXNMI0NKg4AkIAJABg7XzYBcwDg5sf3ze3Pr7VXXwntGmpx7/6q+7ddszw8fDHVv+Kl/v5YXuZ/0x7H+K9ezpQAYCvypwZAIwAYA9cHwIfHg+3lq7F6WVuAYV5RCaEe0n4tAPGIZtUCYDclTgCAthTPAgDPqBIAoBZgrN7EAJAPKQUA3mOaEwDytvQNmoaST0yabjG2SGMSMAsAio0BxgtLxQDwHNT8AACagMkAWM8VgM8vn46zQE+nnAWyAaAfUiIA3Ic1HwCk8SwCJgXA6ARBQ4D6AOhn/8VXf/LrAC7JlQUlAXAdFwNASrNxAuDIqAQA014JdsoGIOCQ0gHguruTeihSBQHoX5oETAPAeGW6bgCClBkAZWmZZwEppJQAoIeWFwCXAgG4MgDYAGko+USlkXuyDACMBCwBAGuh5AwBQDe4IB6KIvJSiJT7AumuKwJAM65NUqoCDgGyACBuiLnGT2pGAOzFwgE3n+tGC6pcWgCQgyMeipqFFwDSw3kCAdA73hMD0BfXNgEAAK6MMACObXkqtwNA3CFwiZzbbACYq+VPyK45qQsAmADKoRh5ENYCBd8QgwsFYGOloeQTlWYoTQWgr0wOANBtUcSH2IOC8wBgub8zNR0A3WhhlUsNAIgA4VDMLAgtQB4AlHcnBWAsbACgyQyAa1uUSVsAo+s//k4CQPM/ZSMJU+kBAAjwHoqdhX8MQNiTLxAAc/3BgQOAbovy8QH23EH9fgDqo7LdABj2R9+bDwA2Aj4AgBwIXSDSI5L2BWBjpKHkE5NGFjXeoDZWBx4D7zkIdmyLQtwYa3hEknc05gQA8TqRACMRZS8tQ1kAMAlwA0AoZZJpUGsNchkAmvEOzaFCsP8TAABviyJE2BqR9qTysXpOABBrewkw01QDgHGUTgAopUwBALAZnEZAVgDUgiYCANsWRbyitABJAHDZ3E+AlYK0naiuXADo27YH+58AQOrrAMBtWOUAWLev+iplagGQbVHE/e6UMYB8SiThOVUwAO6uvrcNsBPQdlTXlA2ATl4AaKWAs0CPxF7enslQOgDQnejNVABofS0TAGQIkGIMECpgd+gdMBgugzAAPEPdV57PgSaiPgA64QAQS0GuA/RNt0MJANjINJR8otLo800GAYj/ywNAFQKA7xv+FaWF0N+K8OYkAGyxS8TUUhAALu+nekQSMAAQqgGAqzwARCklAN4ezit3IuiTigFo4CcBEkuB/sLnrfs9/c89AWimAcBcdzcPAEiDMCEQAP8szyvU51h8vDfzRowhdP8TABCb2J+jwzUZSAYA+kCxZmYA1N/1JqBSAGiLsYQgAAiznK+cCSH/Vw+A/TRwYim5p0GxBkD1JgOQcHdoyiz/K8Xp8PMljIAZABAb4v8Ly3vwbr47PX2mBM4QANkHajr/1wgAbTGWkA0A6SrXMHVycmIxgPh/YQCoDyqXe/GJ3Thuvld25CAUjvtf6QPlA8DegkJtAjD/lwaAthhLyAKAts5Bzh0aBCCTQ83CANAeVC734fggMHjzTAbuB0AzEQD6O8qG1dUCQFuMJQQD4PO/dvXoxJKVXC+ErNkCoD+nWd+JSdmVb0tQ63/sQ+FOSibx2gBFdLfFCLUAeHKY2TQozf/65VOS/xcMgLYXn9iVRgZ6C79yNQCyf5KtBYA24VL6QLW2AHQZABD9b60fcNl/gQDoDypXW4Dbn56qgTQA8I8nAcBKI/tAAgCweiUBaL9+4rpAq1gAnE/W7fJeFADag8qVvfhuvnumBfoK9/g/OwBAA9ADsBYvj6oEIEgAAAT/h22l0OW9LABUyb34NP8TAOgGAI4Eg0ELAgADOlMAGqL/gwDos14uAHJXvnenQuRZoCsvAE1eACD/izRlABieFI9M8euzQL5VoIOsQTDN1AEADFkvCoA09wN0HaBKAVg3AwAQAX4Ajmx5KtdZ/xJ79qDeApyvCM/pbIBpUAYgNCTbvkD9AKAwAGCaDoCjXAA4tkXZvUcCoLsW4H9QVXYAgFNC1mwBSLMvUD8ArhsA+F6FfQFAt0W5+/N/UrpAQzb+eSAGIE8LkACAwVleADa5AAB7QNMAgG2LcvmINAYQumz3RDmPvSUyEQDQKSFrtgCk2BfoigRAkxsAOE0LQG9akID9BsHotigf/+U3GgB3z1er4b54Z1GZAVBKWhQA+w+C5RWAWgFY91/a4LWK/QEAt0W5dDx+WZ8FIi+G0xduvEqsZGtSKhZ8Uzzl3DtMeVUBAHAPqEujAAA2AXsCgG2L0hCnQfdZDp2yBVBLWlILsPcgWF0CVBQALI0KAETAvi0Ati0K+TpAQgCgDxkAqQyDYG0JnB+ATREAjnICsO+uEL7tgEZ5AbAiAgDQ4pYEALqFtxkIF64vAfVUMBsASA9IA6B/yyagMAB73A/g83+XiAGQSr85rj6sLAkAmsYG4MpO1Gpea4Eo/hepSADoQUsCgCYMAMNOVQLQrI+WAAAatmUARmUBAC3NUnfPFqG4DACM71kElAZgv32BCADYaT3+ZwAsIQDgXoKVCQBsCDCkqRoA2uasQk4A8LCtnZgBCBUIgH0PZEEAXGkEAOvxzcoAoG3OKuQCwBG2tVN7/M8AWIIAAO4BpgAAW1VXWgCObADgflsxAPybswo5AHCFbe3kHv8zAJZsAK6ge+C9FSwGwHBnsFBdANA2ZxXaDwAHAngIXQsDALR/3QCs5dvY1FUZAEibswrhADjDXJfOkGgGwJQBAOL/QgDgHas2zVHlAJC1NwAwAe4QqhYIgLc0QMRBQDgAjjS9/9fK+8jVuwLbovwpIAoFwB2mnkya/xkASxoAyNe/VRqkggCs5fvI+o0S+wIR5v8HJQCAtn6CAbCkAoD7vwwAjlZlBKBxNAFlu0BiKQpxOSgGgCfMOJkE/zMAliQAWPcfKA1SJgBcaSAAVAJyANDeEolf3tXHAJeUO+KbVABQZo8YAFMGALTSINEGAfsDcDyovxtyjTcBfgA2tjyVEwAgD8kWAnaFIKyJTgQAIZIBMKUDQCwN1BQAHKvq10HgTcB+AKDbotz9GZ/YBGaB4i+E+cKAk+kLZABMKWMA1/6fJQDQ/XhsyQGAeR9nFADYtijtOnP6vkDxLYAvrITRqikk35VgQmmgSH2gUACG92z7dwDs/oH6QGkAQLZF+fiwvVsezDDlGMAbxgBIVQAAqQmIBED1fZ9mBKBlQI0fCdhvEIxui9J+iowDUs4CecMYAKkUAAzm8pcGKzEAGxAAmeZIAnC8VuMTAgBui9J+6gOgv42eJhAAfxgDIJUAAOf2sIUA6F5p1h/TKP43PkwEALYtinh19xfPNOinfyXeED9WjwHYJyQlABAIVAB8BEQAAFl8AAD+eGgC9m0BsG1RLlfot3vCtUD+MAZAKgcAKggk4yYFYMAJ9P8ujWTUTpEIgH23RSELAoAQxgBI5QTA1TXSapQcgAbs/nRplBphBDAAZUJmCkCrfnYxCoR8AEBplJqs1yYBKQCIEgMwVSH5pkHVafYgBnIAgPi/2R5pAPQIyM9bAooDsBssnFG2hwMAoBTGAEilvQ6gTa6QKdgSRsFkADYSADCNWoERAJm0HQeXBuBcPKeW8qAeBqAyAOyJ9y0MglGjxADg/rcBAAkYfyt1U7zypHKXbABIhTEAUsmvBFtXXkc5ekbCte7BcioAdPzaxRA6AfrabgZgypCDAMDoB2lpPABgYwS71niargeE+l/fEatfD2cTMCYo0wW6FF2gT09iHpJHKowBkMqzFkgyAKRxAYAiEAIAOgI2G4DhngCTgNJjgObafJRM97BmIfG05m/e9m9bANAKYwCkci2GGwgA04AAuAkIAQC5BDCWrPzeLwg1IooDYOrzy2fNu2/bl2+eKe8zANUCoHeEvDVSAIhfU6QBACcxsx9WROtVrQ6A21/eNjc/iO/9z397rbzPABQEwPv4sREBwqPKhG+324GA+EeebQYA4I+t3Ns+kKysFVDJ7tA3P75vbn8W1t/1hU5P20bgKyG9tot4ql1i5b0fgNYIbJUVnFgbQGwBBv8jKezMx5tijLnbXoV2hzavAJzFwPEAAAk9SURBVHx4PABw8/1rpRUwWwBiYdwCSOW+IYaCwFZbEAoTEAYAkgDIWt4VVg8A+sbob05Pv5UtQPfWMA4wAKCKAZCaCAAnAePsTSu4DcgJwFqpqlFYoRbAvGlGjgFaMQDpQia4JdKLgA4ATEAQAFgCiCzlxuBaALAvgX1++bSfBRKdoc9/R6ZBqWIApCa5J9hDgLyA1SkegM1eAIwElAbAfkRSdx1ANALvTk+/HvtCDMA8APAQoCxh6AQQQAfAQRoGwLp/PdSyeBeItCVEwwDMBgB3PygxAOjn8PDabAKOiwMQ/aR4qhgAqYkBgJcoix/agtBIADZ+AOx8LACOSwNgD4IxMQCzAcBFwAiAowkgA+AYbPsBaKoAoLufniIGYD4AOHpBXZqSAKz1ShbvAq3inhNMFQMgNenOcAgCNgA2AZSyPDeWHcEAGHuE6jWsZC0QJgZgXgCgW5UIuftAVAA8DQCUDwDAmAsDMGXI4QMAI9CncTYBVADwT49cAKz1Go6/TA9AezsYd4EmC5l+c1wbgUQAUHpAYD7GLtHFxwB0MQAzBMAmQAEAnQn1l3VM8T8FgLLXAegXARoGYJ4AWAgMaVxNgLesY1IDwADERTAAlhIAcGyk0R2cFoCBJwYgKoIBsLQPAA18/4mrD+Qr65jWA0IBWMOVZgCmDFkSAODy+30AIPSA0HzqAmA1iGeBJggpDIC++tgxCPCUdXxAAHALMGVIOQAkATAATQAAJP8zAIMYAKmCAIwEaAAgfSBnWcfkBoABiItgACwlAGCYDZJp4gA47gFwpPEDsAYrzQBMGbI4AKxrYvggwNeV2gsAswkoCUCQGICZA2CuPYsBYPS/A4AjBkAVAyBVGgB9/bE9Ch4IQPM5HgFwlCUzwgFYQ5VmAKYMWTAAIAF0ABo3AP58GIAaQpYJgEYA2gRg+fSxDECIGACpCgDACSACMMyfYmkIYwkGoIaQpQKwVQjAroUh+fRxXdSeAKyBSjMAU4YsFoAGI8A3e6M0AHga0vUEBqCCkOUCoBCA3BoM56M1AAwAVQyAVCUAKJfEYAJcAAwBcBraqlKtD8QAlAlZMgCSgI1KgBsAdQSMlkVcVs0AlA9ZNACyGwQ2ATgAMjmUhnxzPQNQPmThAGiT+mYTAOQjL4ExAGFiAKTqA2A0devqjZQZJhcBbfCyyBtsqYMABqBMyOIBGAjYYNLCTP9DZZkNgKM+swSg9DMW56+6AFDXtvkYkAkdZR06AOLHPL5pqymk6hZAyIvAZkxnIGGXZfnfA8DaTMQATBnCALQyBgLDlob+btF+ADQMQOkQBqCXdpeYsquzZ1hg5WP7nwGIi2AALOUEQCegtfGQxjUqNvM5YgBgMQBS9QIwEmD4GPU/DAC9PnIQwACUCakTgO4RtZ2Up5VnBcBJgPU5nA/0/e+uDwNQOKRKAD6/fNY/pLxpPpx+MyUAOgHWx858jmD/MwBxEQsG4PaXt8MX/5uv/zFVC2BY3HQz6H81H8z/DEBcxIIBuPnxfXP78+v+lw6Ar4QyX6ETHpe/dX6GP1MS6AotUgBgvMUATBlSJQAfHtsA9IE5WwBoLnT8RgdaB0DB9RlHwdwClAmpEgCoBegDpwRgK42ufoK6H/G/uz4MQNmQKgFQxgDTAqATsHV5ne5/BiAuYsEAfH75dJwFmh4A9TliXsPvXR8GoGxIlQD01wE6608KgEZAm8bzXc8AEMUASNV5JbiTejFgTHOMd3WSALBuGIBSIQyAIQAA+BJYgrJaMQBFQxgAU9LuW+UNBmAQA3DgAEgCtvJXzP8MAFUMgNQcABgfpOf2fyIA1gxAqRAGwNbg+W3j9X+K+jAAJUMYAEASAJ//GQCqGACp6gEY90rx+p8BoIoBkJoZALnL6gYBDECZEAYAFtH/ScpiAAqGMACIaP5nAKhiAKRmAcCEaRiAgiEMQPk07SCAASgTwgBUkIYBKBfCAFSQhgEoF8IAVJCGASgXwgBUkEZ7Wh4DMGkIA1BDGgagWAgDUEMaBqBYCANQQxqtD1QPAMPt2OpWrQwAA5AhTZUADNuyqlu1MgAMQI40NQIwbsuqbdPEADAAGdLUCMDYBZIb9U2xQesCxABYqvM6QA+AtlUrtwDcAuRI01QFwJvTU9Hnt1oAIQaAAciQpi4Aet3wGCBLCAPgTFQdANpWrQwAA5AjTbUAiP/5OkDaEAbAmageAEAxAAxAhjQMQKEQBqCONAxAoRAGoI40DEChEAagjjQMQKEQBqCONAxAoRAGoI40DEChEAagjjQMQKEQBqCONAxAoRAGoI40MwKAtbdi/2Kl6z2RYk9PqOIAaDVJHQ+nkISlpMqptnym+96XYgCmKoQBmDAjuhiAqQphACbMiK49AGCx5i8GgLVoMQCsRYsBYC1aDABr0YoFQLtDMpPa25HzFnTz3enps+xH8+G03V8vTSmJ6prm5CY7f0lPUYgiAdB3SsyjdlfGvAWJjV5uvn+d+WiE13bZpyklUV3TnNxk5y/pKQpSJAD6LilZ1O3KmLegD+Jkv3k2wdHssk9TSppcEp3cpOcv2SkKUiQA+j5ZmdRuSJG9oF3uExzN7nstTSmp6prs5CY7f8lOUZAiAdB3Sswk8TfKXpDY8Ch7ITffff06USmp6prq5KY6fwlPUZCW3gLc/vR0kqNJ9j1ZWQuQ8PxN0xSbqncM0P2NMhd0892zZpqjSdVTTlXXNCc36fmbZDBmKnoW6Gn+4bo4FXkL6v5+uY+mb9jTlJKqrklObrLzl/QUBWnZ1wHenQo9y300u2J2HdwDvA6Q7vwlPUUh4ivBrEWLAWAtWgwAa9FiAFiLFgPAWrQYANaidRgA3D1fdbr/8eGL0pWZu5Z1Mg8DAKEl/LUm03JOJgPAArSck3loAOx+fnz41wer1aOPux9nXYP+5a+lKzc3LedkHiIAD+791lyuxI8vf717fr9pLnevWSFazsk8SAB231Xdj4cvrsUX1qcnZ6VrNzMt52QeIgDixfDjspvQeFS6djPTck7mwQNwWA32VFrOyTx0AK6/WMp0RlIt52QeOgB3z3ffWof4h8ur5ZzMQwegnbk7rD/ZFFrOyTwcAFisCDEArEWLAWAtWgwAa9FiAFiLFgPAWrQYANaixQCwFi0GgLVoMQCsRev/AaPpJ5TkRFbnAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
<p>By default, the lwqs function will generate two plots to summarize the model output, as in the above. In the left panel, the time-varying effect estimate associated with the exposure mixture is shown. Note that the confidence intervals on this estimate overlap zero except for the interval from ~11-20. This would be interpreted as the “critical window” in which our simulated exposures positively relate to the outcome of interest. In the right plot, the time-varying weights estimated for each predictor contributing to the mixture are shown. We would focus our interpretation on time points where the mixture is significant, i.e. where the confidence intervals at left depart from zero. At those time points, the mixture is dominated by predictors 1 and 2, with predictor 1 contributing the most, consistent with the parameters of the simulation.</p>
<p><strong>Note: in the code provided the “b” parameter is set to 5, which indicates 5 bootstrap samples are used at time point in the ensemble estimation step. This is done purely to create a fast-running example; in practice, the number of bootstraps must be sufficient that one can have confidence of an accurate aggregate estimate</strong> This parameter should be tuned with use but in general between 30-100 bootstraps may be sufficient for the standard ensemble, depending on processing limitations.</p>
</div>
<div id="identifying-mixture-effects-negatively-associated-with-outcomes" class="section level3">
<h3>Identifying mixture effects negatively associated with outcomes</h3>
<p>The procedure for testing for mixture effects in opposing directions is identical except for the reversal of one parameter. To test for negative associations with an outcome, alter the “b1_pos” parameter in the call to the gWQS function to be set to “FALSE”, as in the below. This will specificy the estimation of mixtures constrained toward negative associations.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">negmod=<span class="kw">lwqs</span>(<span class="dt">data=</span>lwqs_data,                       </a>
<a class="sourceLine" id="cb7-2" title="2">            <span class="dt">timevar=</span><span class="st">&quot;time&quot;</span>,                       </a>
<a class="sourceLine" id="cb7-3" title="3">            <span class="dt">wqs_parms=</span><span class="kw">list</span>(<span class="dt">formula=</span>out <span class="op">~</span><span class="st"> </span>wqs,     </a>
<a class="sourceLine" id="cb7-4" title="4">                           <span class="dt">data =</span> lwqs_data,           </a>
<a class="sourceLine" id="cb7-5" title="5">                           <span class="dt">mix_name=</span>mixvars,      </a>
<a class="sourceLine" id="cb7-6" title="6">                           <span class="dt">b1_constr =</span> T,         </a>
<a class="sourceLine" id="cb7-7" title="7">                           <span class="dt">b1_pos=</span>F,              <span class="co">#Parameter to specificy directionality. Specify &quot;F&quot; for negative. </span></a>
<a class="sourceLine" id="cb7-8" title="8">                           <span class="dt">b =</span> <span class="dv">5</span>,                 </a>
<a class="sourceLine" id="cb7-9" title="9">                           <span class="dt">q =</span> <span class="dv">5</span>,                 </a>
<a class="sourceLine" id="cb7-10" title="10">                           <span class="dt">validation =</span> <span class="dv">0</span>,        </a>
<a class="sourceLine" id="cb7-11" title="11">                           <span class="dt">family =</span> <span class="st">&quot;gaussian&quot;</span>,   </a>
<a class="sourceLine" id="cb7-12" title="12">                           <span class="dt">seed =</span> <span class="dv">1</span>),          </a>
<a class="sourceLine" id="cb7-13" title="13">            <span class="dt">outcome=</span><span class="st">&quot;out&quot;</span>,                        </a>
<a class="sourceLine" id="cb7-14" title="14">            <span class="dt">ID=</span><span class="st">&quot;ID&quot;</span>)                              </a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>#&gt; `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As in the prior example, the lwqs function automatically generates two plots to summarize model estimates. At left, the time-varying mixture effect estimates depart from the zero boundary line from time points 1-10, indicating that within this window the simulated predictors are negatively associated with the outcome. At right, we see the weights associated with the mixture in this window are dominated by predictors 3 and 4, which, as per the simulation parameters, exert a moderate and strongly negative association with the outcome.</p>
</div>
</div>
<div id="adjustment-for-covariates" class="section level2">
<h2>Adjustment for covariates</h2>
<p>The models estimated thus far have considered the time-varying association of 5 predictors with a health outcome, but have not been adjusted for covariates. The lwqs algorithm can be adjusted for covariates at two levels; either in the estimation of mixture effects at each sampling interval, or in the estimation of time-varying effects. Users can choose to apply either, neither, or both strategies.</p>
<div id="adjustment-for-covariates-in-mixture-estimation" class="section level3">
<h3>Adjustment for covariates in mixture estimation</h3>
<p>Adjustment for covariates at the level of mixture estimation at each sampling interval can be done by modifying the gWQS parameter used in the lwqs function, as below. When specifying the call to the formula used in estimating each interval-specific mixture, simply add the covariate terms to the model formula.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">negcovmod=<span class="kw">lwqs</span>(<span class="dt">data=</span>lwqs_data,                       </a>
<a class="sourceLine" id="cb9-2" title="2">            <span class="dt">timevar=</span><span class="st">&quot;time&quot;</span>,                       </a>
<a class="sourceLine" id="cb9-3" title="3">            <span class="dt">wqs_parms=</span><span class="kw">list</span>(<span class="dt">formula=</span>out <span class="op">~</span><span class="st"> </span>wqs <span class="op">+</span><span class="st"> </span><span class="kw">as.factor</span>(sex),   <span class="co">#specifies covariate adjustment for sex variable     </span></a>
<a class="sourceLine" id="cb9-4" title="4">                           <span class="dt">data =</span> lwqs_data,           </a>
<a class="sourceLine" id="cb9-5" title="5">                           <span class="dt">mix_name=</span>mixvars,      </a>
<a class="sourceLine" id="cb9-6" title="6">                           <span class="dt">b1_constr =</span> T,         </a>
<a class="sourceLine" id="cb9-7" title="7">                           <span class="dt">b1_pos=</span>F,              </a>
<a class="sourceLine" id="cb9-8" title="8">                           <span class="dt">b =</span> <span class="dv">5</span>,                 </a>
<a class="sourceLine" id="cb9-9" title="9">                           <span class="dt">q =</span> <span class="dv">5</span>,                 </a>
<a class="sourceLine" id="cb9-10" title="10">                           <span class="dt">validation =</span> <span class="dv">0</span>,        </a>
<a class="sourceLine" id="cb9-11" title="11">                           <span class="dt">family =</span> <span class="st">&quot;gaussian&quot;</span>,   </a>
<a class="sourceLine" id="cb9-12" title="12">                           <span class="dt">seed =</span> <span class="dv">1</span>),          </a>
<a class="sourceLine" id="cb9-13" title="13">            <span class="dt">outcome=</span><span class="st">&quot;out&quot;</span>,                        </a>
<a class="sourceLine" id="cb9-14" title="14">            <span class="dt">ID=</span><span class="st">&quot;ID&quot;</span>)                              </a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>#&gt; `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Interpretation of the covariate-adjusted model is otherwise identical to previous models; that is, the mixture effect estimates (left panel) indicate a significant negative association with the outcome from time 1-10, and this is driven by predictors 3 and 4 (right panel). The key difference is that in this model those estimates are adjusted for sex.</p>
<p>To evaluate the time-specific significance of each covariate, one could use output stored in the saved model to evaluate parameter estimates for WQS models constructed at each time point. The below code, for example, provides a model summary at time point 1.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="co">#gWQS (and covariate) effect estimates at time point 1</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="kw">summary</span>(negcovmod<span class="op">$</span>parameters<span class="op">$</span>res<span class="op">$</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span>)</a></code></pre></div>
</div>
<div id="adjustment-for-covariates-in-longitudinal-model-estimation" class="section level3">
<h3>Adjustment for covariates in longitudinal model estimation</h3>
<p>It may also be advantageous to consider how covariates modify the estimation of time-varying effects. The default lwqs model does not provide this, but an additional function, extract_mixture, can be used to extract the time-varying mixture estimated during the lwqs procedure, at which point it can be used as an input to the gamm4 procedure to allow for covariate adjustment. As an example, the previous model implemented (saved as negcovmod) has implemented an lwqs with adjustment, at the level of the mixture, for sex. Here we use the extract_mixture function to pull the time-varying mixture estimated in this model:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co">#extract time-varying wqs index</span></a>
<a class="sourceLine" id="cb12-3" title="3">timewqs=<span class="kw">extract_mixture</span>(negcovmod)</a></code></pre></div>
<p>Next, we will merge the covariate data from our original dataset, and input this in a gamm4 model.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">library</span>(gamm4)</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="co">#&gt; Loading required package: Matrix</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="co">#&gt; Loading required package: lme4</span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="co">#&gt; Loading required package: mgcv</span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="co">#&gt; Loading required package: nlme</span></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="co">#&gt; Attaching package: &#39;nlme&#39;</span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="co">#&gt; The following object is masked from &#39;package:lme4&#39;:</span></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb13-10" title="10"><span class="co">#&gt;     lmList</span></a>
<a class="sourceLine" id="cb13-11" title="11"><span class="co">#&gt; This is mgcv 1.8-31. For overview type &#39;help(&quot;mgcv-package&quot;)&#39;.</span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="co">#&gt; This is gamm4 0.2-6</span></a>
<a class="sourceLine" id="cb13-13" title="13"></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="co">#merge covariate data</span></a>
<a class="sourceLine" id="cb13-15" title="15">timewqs=<span class="kw">merge</span>(timewqs, <span class="kw">unique</span>(lwqs_data[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]))</a>
<a class="sourceLine" id="cb13-16" title="16"></a>
<a class="sourceLine" id="cb13-17" title="17"><span class="co">#reconstruct gam with fixed effect of sex</span></a>
<a class="sourceLine" id="cb13-18" title="18">sexgam=<span class="kw">gamm4</span>(wqs <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(time, <span class="dt">by=</span>y, <span class="dt">bs=</span><span class="st">&quot;cr&quot;</span>) <span class="op">+</span><span class="st"> </span>sex,   <span class="co">#model formula</span></a>
<a class="sourceLine" id="cb13-19" title="19">             <span class="dt">data=</span>timewqs,                         <span class="co">#dataset</span></a>
<a class="sourceLine" id="cb13-20" title="20">             <span class="dt">random =</span> <span class="op">~</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID))                 <span class="co">#random term for within-subject correlation</span></a>
<a class="sourceLine" id="cb13-21" title="21"></a>
<a class="sourceLine" id="cb13-22" title="22"><span class="kw">plot</span>(sexgam<span class="op">$</span>gam)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This will yield a gamm4 object, from which corresponding plots and parameter estimates can be extracted (see package gamm4 for details). Importantly, note that the error intervals provided in gamm4 are expressed in standard error, rather than 95% confidence intervals. If the latter are of interest toward the research question, these should be expressed with respect to a appropriate critical value, e.g. multiplied by 1.96, assuming a standardized distribution. This is done automatically with the lwqs function, which assumes a z-scored outcome distribution. Effect estimates and corresponding SEs can be extracted from the gamm4 object.</p>
<p>Note as well that the construction of customized gamm4 models to capture mixture effects allows tremendous flexibility in the selection of basis functions, knot intervals, estimation procedures, random effects, and related parameters; these choices may be critical in extending lwqs to contexts such as twin studies, modeling time-varying covariates, and/or focusing on critical intervals. Care should be taken in model selection procedures to ensure appropriate model specification.</p>
</div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<ol style="list-style-type: decimal">
<li><p>Gennings C, Curtin P, Bello G, Wright R, Arora M, Austin C. Lagged WQS regression for mixtures with many components. Environ Res. 2020;186:109529. Epub 2020/05/07. doi: 10.1016/j.envres.2020.109529. PubMed PMID: 32371274.</p></li>
<li><p>Carrico C, Gennings C, Wheeler DC, Factor-Litvak P. Characterization of Weighted Quantile Sum Regression for Highly Correlated Data in a Risk Analysis Setting. J Agric Biol Environ Stat. 2015;20(1):100-20. Epub 2015/03/01. doi: 10.1007/s13253-014-0180-3. PubMed PMID: 30505142; PubMed Central PMCID: PMCPMC6261506.</p></li>
<li><p>Chen YH, Ferguson KK, Meeker JD, McElrath TF, Mukherjee B. Statistical methods for modeling repeated measures of maternal environmental exposure biomarkers during pregnancy in association with preterm birth. Environ Health. 2015;14:9. Epub 2015/01/27. doi: 10.1186/1476-069X-14-9. PubMed PMID: 25619201; PubMed Central PMCID: PMCPMC4417225.</p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
